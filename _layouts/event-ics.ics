---
layout: null
---
BEGIN:VCALENDAR
CALSCALE:GREGORIAN
VERSION:2.0
PRODID:-//AntennaPod//Website events section 0.1//EN
LAST-MODIFIED:{{ 'now' | date: "%Y%m%dT%H%M00Z"}}
BEGIN:VEVENT
DTSTAMP:{{ page.datetime-start | date: "%Y%m%dT%H%M00Z" }}{% if page.sequence %}
SEQUENCE:{{ page.sequence }}{% endif %}
UID:{{ page.uid | upcase }}
DTSTART
{%- if page.timezone -%};TZID={{ page.timezone }}{% endif %}:
{{- page.datetime-start | date: "%Y%m%dT%H%M00" }}{% unless page.timezone %}Z{% endunless %}
DTEND
{%- if page.timezone -%};TZID={{ page.timezone }}{% endif %}:
{{- page.datetime-end | date: "%Y%m%dT%H%M00" }}{% unless page.timezone %}Z{% endunless %}
STATUS:CONFIRMED
SUMMARY:{{ page.title }}

{%- capture description %}
DESCRIPTION:
{{- page.content | remove_last: '</p>' | replace: '</p>','\n\n' | strip_html | replace:',','\,' | replace:':','\:' | replace:';','\;' | strip_newlines }}
{%- if page.location == 'online' %}{% if page.location-label %}\n\n{{ page.meeting-room }}{% endif %}{% endif %}
{%- endcapture %}

{%- assign descriptionChars = description.size %}
{%- assign descriptionTotalRows = descriptionChars | divided_by: 74.00 | ceil %}
{%- assign descriptionChars = descriptionChars | plus: descriptionTotalRows %}
{%- assign descriptionTotalRows = descriptionChars | divided_by: 74.00 | ceil %}
{%- assign descriptionChars = descriptionChars | minus: descriptionTotalRows %}
{%- assign start = 0 %}
{%- assign separator = '\||/' %}
{%- assign descriptionWorker = '' %}

{%- for rowToBe in (1..descriptionTotalRows) %}
  {%- if descriptionChars <= 74  %}
    {%- assign descriptionWorker = description %}
    {%- break %}
  {%- else %}
    {%- assign descriptionRow = description | slice: start, 73 | prepend: ' ' | append: separator %}
    {%- assign descriptionWorker = descriptionWorker | append: descriptionRow %}
    {%- assign start = start | plus: 73 %}
  {%- endif %}
{%- endfor %}

{%- if descriptionChars > 74  %}
  {%- assign descriptionWorker = descriptionWorker | lstrip %}
  {%- assign lastChar = descriptionWorker.size | minus: separator.size %}
  {%- assign descriptionWorker = descriptionWorker | slice: 0, lastChar %}
  {%- assign descriptionArray = descriptionWorker | split: separator %}
{%- endif %}

{%- for descriptionLine in descriptionArray %}
{{ descriptionLine }}
{%- endfor %}
LOCATION:{% if page.location-label %}{{ page.location-label }}
{%- elsif page.location == 'online' %}{{ page.meeting-room }}
{%- else %}{{ site.data.event-links[location].url }}{{ page.location }}
{%- endif %}{% if page.location == 'online' %}
URL:{{ page.meeting-room }}
CONFERENCE:{{ page.meeting-room }}
{%- endif %}{% if page.recurring == true %}
RRULE:{{ page.recurrence-rule -}}
{%- endif %}{% if page.recurrence-exceptions %}
EXDATE
{%- if page.timezone -%};TZID={{ page.timezone }}{% endif %}:
{%- for exception in page.recurrence-exceptions %}
{{- exception | date: "%Y%m%d" }}T{{ page.datetime-start | date: "%H%M00" }}{% unless page.timezone %}Z{% endunless %}
{%- unless forloop.last %},{% endunless %}
{%- endfor -%}
{%- endif %}{% if page.recurrence-additions %}
RDATE;VALUE=PERIOD
{%- if page.timezone -%};TZID={{ page.timezone }}{% endif %}:
{%- for extra-occurrence in page.recurrence-additions %}
{{- extra-occurrence.start | date: "%Y%m%dT%H%M00" }}{% unless page.timezone %}Z{% endunless %}/
{{- extra-occurrence.end | date: "%Y%m%dT%H%M00" }}{% unless page.timezone %}Z{% endunless %}
{%- unless forloop.last %},{% endunless %}
{%- endfor -%}
{%- endif %}
END:VEVENT{%- for timezone in site.data.ics-timezones %}
BEGIN:VTIMEZONE
TZID:{{ timezone[0] }}
{{ timezone[1] }}
END:VTIMEZONE
{%- endfor %}
END:VCALENDAR
